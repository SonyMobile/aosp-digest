aosp-digest
===========

Scripts to query AOSP Gerrit for newly merged changes and optionally notify a
list of recipients via mail.


Intended workflow
-----------------
Execute "update-cache.py && send-email.py -a" on a recurring basis.


Hacking
-------
- Limit which users receive a mail: "send-email.py --user=firstname.lastname".
  This expects a file users/firstname.lastname.py exists. The --user option may
  be given multiple times.

- Expected content of users/firstname.lastname.py file is:
  email="email@domain"
  filters=[
    (("title", predicate))
  ]]
  where predicate is a regular python function used to filter out the changes.

- Print debug information on stdout instead of sending emails:
  "send-email.py [-a|--user=...] -d".


.netrc
------
The Gerrit API used by update-cache.py requires an authenticated login. Add the
following lines to ~/.netrc:

machine android.googlesource.com login USERNAME password PASSWORD
machine android-review.googlesource.com login USERNAME password PASSWORD

The USERNAME/PASSWORD credentials can be obtained as follows:
- log into https://android-review.googlesource.com/ and go to Settings/HTTP Password.
- The page creates an entry for .gitcookies file in the format
  android.googlesource.com	FALSE	/	TRUE	2147483647	o	USERNAME=PASSWORD
- copy/paste the USERNAME and PASSWORD portions to .netrc file

muttrc
------
send-email.py uses mutt to send emails. For mutt to pick up the correct settings,
place a local configuration file for mutt (muttrc) here. The contents should be
as follows:

# SMTP config
set realname = "Full name"
set from = "email.address@sdomain.com"
set smtp_url = "smtp url"
